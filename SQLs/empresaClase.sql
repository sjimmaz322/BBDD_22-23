DROP DATABASE IF EXISTS empresaclase;
CREATE DATABASE  IF NOT EXISTS empresaclase ;
USE empresaclase;
-- 
CREATE TABLE centros (
    numce INT(11) NOT NULL,
    nomce VARCHAR(60) NOT NULL,
    dirce VARCHAR(60) NOT NULL,
    codpostal CHAR(5) NOT NULL DEFAULT '00000',
    CONSTRAINT pk_centros PRIMARY KEY (numce)
);
-- 
INSERT INTO centros VALUES 
(10,' SEDE CENTRAL',' C.ALCALA, 820, MADRID 28090','28090'),
(20,' RELACION CON CLIENTES',' C.ATOCHA, 405, MADRID','28078'),
(30,'GESTIÓN CENTROS SUR','C/ Real nº 18, 29680- Estepona','29680');
-- 
CREATE TABLE departamentos (
    numde INT(11) NOT NULL,
    numce INT(11) NOT NULL,
    presude DECIMAL(10 , 2 ) NOT NULL,
    depende INT(11) DEFAULT NULL,
    nomde VARCHAR(60) NOT NULL,
    CONSTRAINT pk_departamentos PRIMARY KEY (numde),
    CONSTRAINT fk_deptos_centros FOREIGN KEY (numce)
        REFERENCES centros (numce)
        ON DELETE NO ACTION ON UPDATE CASCADE,
    CONSTRAINT fk_deptos_depen FOREIGN KEY (depende)
        REFERENCES departamentos (numde)
        ON DELETE NO ACTION ON UPDATE NO ACTION
);
-- 
INSERT INTO departamentos VALUES
(100,10,129000.00,NULL,'DIRECCION GENERAL'),
(110,20,100000.00,100,'DIRECC.COMERCIAL'),
(111,10,90000.00,110,'SECTOR INDUSTRIAL'),
(112,20,175000.00,110,'SECTOR SERVICIOS'),
(120,10,50000.00,100,'ORGANIZACION'),
(121,10,74000.00,120,'PERSONAL'),
(122,10,68000.00,120,'PROCESO DE DATOS'),
(130,10,85000.00,100,'FINANZAS'),
(131,20,15000.00,110,'Publicidad');

CREATE TABLE empleados (
    numem INT(11) NOT NULL,
    numde INT(11) DEFAULT NULL,
    extelem CHAR(3) DEFAULT NULL,
    fecnaem DATE NOT NULL,
    fecinem DATE NOT NULL,
    salarem DECIMAL(7 , 2 ) DEFAULT NULL,
    comisem DECIMAL(7 , 2 ) DEFAULT NULL,
    numhiem TINYINT(3) DEFAULT NULL,
    nomem VARCHAR(20) DEFAULT NULL,
    ape1em VARCHAR(20) DEFAULT NULL,
    ape2em VARCHAR(20) DEFAULT NULL,
    dniem CHAR(9) DEFAULT NULL,
    userem CHAR(12) DEFAULT NULL,
    passem CHAR(12) DEFAULT NULL,
    CONSTRAINT pk_empleados PRIMARY KEY (numem),
    CONSTRAINT fk_empleados_deptos FOREIGN KEY (numde)
        REFERENCES departamentos (numde)
        ON DELETE NO ACTION ON UPDATE CASCADE
);
-- 
INSERT INTO empleados 
VALUES
(110,121,'350','2065-02-17','1985-03-15',1000.00,NULL,2,'PEPITA','PEREZ','GÓMEZ','25012345a','sa',''),
(120,112,'840','1970-09-10','1995-10-01',1200.00,NULL,3,'JUAN','LOPEZ',NULL,'12000111a',NULL,''),
(130,112,'810','1958-03-01','1988-03-01',987.00,NULL,1,'ANA','GARCIA',NULL,'23089765a',NULL,''),
(150,121,'340','1972-01-15','2001-01-15',856.00,NULL,0,'JULIA','VARGAS',NULL,'12345678b',NULL,''),
(160,111,'740','1969-03-18','2002-03-18',998.00,NULL,4,'PEPA','CANALES',NULL,NULL,NULL,NULL),
(180,110,'505','1971-02-11','1998-02-11',1967.00,NULL,5,'JUANA','RODRIGUEZ',NULL,NULL,NULL,NULL),
(190,121,'350','1969-01-22','1997-01-22',1174.00,NULL,0,'LUISA','GOMEZ','SÁNCHEZ',NULL,NULL,NULL),
(210,100,'200','1964-02-24','1986-02-24',3000.00,NULL,3,'CESAR','PONS',NULL,NULL,NULL,NULL),
(240,111,'760','1959-03-01','1987-03-01',2145.00,110.00,1,'MARIO','LASA',NULL,NULL,NULL,NULL),
(250,100,'250','1954-07-12','1976-07-12',3123.00,110.00,2,'LUCIANO','TEROL',NULL,NULL,NULL,NULL),
(260,100,'220','1960-09-10','1979-09-10',1896.00,NULL,0,'JULIO','PEREZ',NULL,NULL,NULL,NULL),
(270,112,'800','1979-10-08','2003-10-08',1215.00,110.00,2,'AUREO','AGUIRRE',NULL,NULL,NULL,NULL),
(280,130,'410','1964-02-15','2000-02-15',978.00,NULL,2,'MARCOS','PEREZ',NULL,NULL,NULL,NULL),
(285,122,'620','1966-09-10','1989-09-10',867.00,110.00,4,'JULIANA','VEIGA',NULL,NULL,NULL,NULL),
(290,120,'910','1962-10-08','1981-10-08',865.00,50.00,2,'PILAR','GALVEZ',NULL,NULL,NULL,NULL),
(310,130,'480','1971-01-15','1993-01-15',1125.00,NULL,3,'LAVINIA','SANZ',NULL,NULL,NULL,NULL),
(320,122,'620','1957-02-05','1978-02-05',1235.00,NULL,0,'ADRIANA','ALBA',NULL,NULL,NULL,NULL),
(330,112,'850','1949-03-01','1972-03-01',998.76,100.00,6,'ANTONIO','LOPEZ',NULL,NULL,NULL,NULL),
(350,122,'610','1949-09-10','1984-09-10',864.00,NULL,3,'OCTAVIO','GARCIA',NULL,NULL,NULL,NULL),
(360,111,'750','1958-10-28','1978-10-10',1724.00,80.00,5,'DOROTEA','FLOR',NULL,NULL,NULL,NULL),
(370,121,'360','1967-06-22','1987-01-20',999.99,NULL,0,'OTILIA','POLO',NULL,NULL,NULL,NULL),
(380,112,'880','1968-03-30','1988-01-01',1111.00,NULL,3,'GLORIA','GUIL',NULL,NULL,NULL,NULL),
(390,110,'500','1966-02-19','1986-10-08',1435.00,NULL,0,'AUGUSTO','GARCIA',NULL,NULL,NULL,NULL),
(400,111,'780','1969-08-18','1987-11-01',1198.00,NULL,2,'CORNELIO','SANZ',NULL,NULL,NULL,NULL),
(410,120,'910','1968-07-14','1988-10-13',735.00,NULL,1,'DORINDA','LARA',NULL,NULL,NULL,NULL),
(420,130,'450','1966-10-22','1988-10-13',968.00,90.00,1,'FABIOLA','RUIZ',NULL,NULL,NULL,NULL),
(430,122,'650','1967-10-26','1988-11-19',1196.00,NULL,2,'MICAELA','MARTIN',NULL,NULL,NULL,NULL),
(440,111,'760','1966-09-26','1988-11-19',882.00,100.00,1,'CARMEN','MORAN',NULL,NULL,NULL,NULL),
(450,112,'880','1966-10-21','1986-02-28',1112.00,NULL,NULL,'LUCRECIA','LARA',NULL,NULL,NULL,NULL),
(480,111,'760','1965-04-04','1986-02-28',1265.00,100.00,2,'AZUCENA','MUÑOZ',NULL,NULL,NULL,NULL),
(490,112,'880','1964-06-06','1986-02-28',2178.00,100.00,1,'CLAUDIA','FIERRO',NULL,NULL,NULL,NULL),
(500,111,'750','1965-10-08','1988-01-01',1009.00,NULL,NULL,'VALERIANA','MORA',NULL,NULL,NULL,NULL),
(510,110,'550','1966-05-04','1987-01-01',1532.00,NULL,NULL,'LIVIA','DURAN',NULL,NULL,NULL,NULL),
(550,111,'780','1970-01-10','1986-11-01',1245.00,120.00,2,'DIANA','PINO',NULL,NULL,NULL,NULL),
(560,111,'780','1980-09-10','2000-11-10',999.00,NULL,1,'HONORIA','TORRES',NULL,NULL,NULL,NULL),
(561,131,'930','1967-06-12','2012-01-24',2040.00,150.00,2,'Rosa','del Campo',NULL,NULL,NULL,NULL),
(562,131,'940','1972-02-12','2012-01-24',1428.00,1428.00,1,'Pedro','González',NULL,NULL,NULL,NULL),
(563,122,'970','1980-10-05','2012-01-30',1836.00,395.76,NULL,'Pedro','González',NULL,NULL,NULL,NULL),
(890,121,'111','1900-01-01','1950-01-01',3060.00,2040.00,NULL,'eva','tortosa','perez',NULL,'eeee',NULL),
(891,121,'111','1900-01-01','1950-01-01',2040.00,2040.00,NULL,'eva','tortosa','perez',NULL,'eeee',NULL),
(999,121,'213','1900-01-01','1950-01-01',2040.00,2040.00,NULL,'eva2','tortosa',NULL,NULL,'qq',NULL);
-- 
CREATE TABLE dirigir (
    numdepto INT(11) NOT NULL,
    numempdirec INT(11) NOT NULL,
    fecinidir DATE NOT NULL,
    fecfindir DATE DEFAULT NULL,
    tipodir CHAR(1) NOT NULL,
    CONSTRAINT pk_dirigir PRIMARY KEY (numdepto , numempdirec , fecinidir),
    CONSTRAINT fk_dirigir_deptos FOREIGN KEY (numdepto)
        REFERENCES departamentos (numde)
        ON DELETE NO ACTION ON UPDATE CASCADE,
    CONSTRAINT fk_dirigir_empleados FOREIGN KEY (numempdirec)
        REFERENCES empleados (numem)
        ON DELETE NO ACTION ON UPDATE CASCADE
);
-- 
INSERT INTO dirigir VALUES 
(100,250,'1989-01-01',NULL,'P'),
(100,260,'1979-09-10','1988-12-31','p'),
(110,180,'1999-05-12','2009-12-31','F'),
(110,390,'2010-01-01',NULL,'P'),
(111,180,'2010-01-01',NULL,'f'),
(112,330,'1989-01-01',NULL,'f'),
(120,290,'1985-12-12',NULL,'p'),
(121,150,'2003-08-03',NULL,'f'),
(122,350,'1986-09-01',NULL,'p'),
(130,310,'1994-04-15',NULL,'p'),
(131,561,'2012-01-24','2013-01-24','p');

SELECT 
    numde, nomem
FROM
    empleados
WHERE
    numhiem <= 1;
